!function e(t,i,a){function n(o,l){if(!i[o]){if(!t[o]){var s="function"==typeof require&&require;if(!l&&s)return s(o,!0);if(r)return r(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=i[o]={exports:{}};t[o][0].call(c.exports,function(e){var i=t[o][1][e];return n(i?i:e)},c,c.exports,e,t,i,a)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<a.length;o++)n(a[o]);return n}({1:[function(e,t,i){"use strict";function a(e){e=e||{},this.settings=e,null==e.statusInterval&&(e.statusInterval=5e3),null==e.loggingDelay&&(e.loggingDelay=2e4),null==e.noProgressTimeout&&(e.noProgressTimeout=1/0);var t,i=[],a=[],r=Date.now(),o={QUEUED:0,WAITING:1,LOADED:2,ERROR:3,TIMEOUT:4},l=function(e){return null==e?[]:Array.isArray(e)?e:[e]};this.add=function(e){e.tags=new n(e.tags),null==e.priority&&(e.priority=1/0),i.push({resource:e,status:o.QUEUED})},this.addProgressListener=function(e,t){a.push({callback:e,tags:new n(t)})},this.addCompletionListener=function(e,t){a.push({tags:new n(t),callback:function(t){t.completedCount===t.totalCount&&e(t)}})};var s=function(e){e=l(e);var t=function(t){for(var i=t.resource,a=1/0,n=0;n<i.tags.length;n++)for(var r=0;r<Math.min(e.length,a)&&!(i.tags.all[n]===e[r]&&r<a&&(a=r,0===a))&&0!==a;r++);return a};return function(e,i){var a=t(e),n=t(i);return a<n?-1:a>n?1:e.priority<i.priority?-1:e.priority>i.priority?1:0}};this.start=function(e){t=Date.now();var a=s(e);i.sort(a);for(var n=0,r=i.length;n<r;n++){var l=i[n];l.status=o.WAITING,l.resource.start(this)}setTimeout(u,100)};var u=function f(){for(var t=!1,a=Date.now()-r,n=a>=e.noProgressTimeout,l=a>=e.loggingDelay,s=0,u=i.length;s<u;s++){var c=i[s];c.status===o.WAITING&&(c.resource.checkStatus&&c.resource.checkStatus(),c.status===o.WAITING&&(n?c.resource.onTimeout():t=!0))}l&&t&&p(),t&&setTimeout(f,e.statusInterval)};this.isBusy=function(){for(var e=0,t=i.length;e<t;e++)if(i[e].status===o.QUEUED||i[e].status===o.WAITING)return!0;return!1};var c=function(e,t){var n,l,s,u,c,p=null;for(n=0,l=i.length;n<l;n++)if(i[n].resource===e){p=i[n];break}if(null!=p&&p.status===o.WAITING)for(p.status=t,r=Date.now(),s=e.tags.length,n=0,l=a.length;n<l;n++)u=a[n],c=0===u.tags.length||e.tags.intersects(u.tags),c&&d(p,u)};this.onLoad=function(e){c(e,o.LOADED)},this.onError=function(e){c(e,o.ERROR)},this.onTimeout=function(e){c(e,o.TIMEOUT)};var d=function(e,t){var a,n,r,l,s=0,u=0;for(a=0,n=i.length;a<n;a++)r=i[a],l=!1,l=0===t.tags.length||r.resource.tags.intersects(t.tags),l&&(u++,r.status!==o.LOADED&&r.status!==o.ERROR&&r.status!==o.TIMEOUT||s++);t.callback({resource:e.resource,loaded:e.status===o.LOADED,error:e.status===o.ERROR,timeout:e.status===o.TIMEOUT,completedCount:s,totalCount:u})},p=this.log=function(e){if(window.console){var a=Math.round((Date.now()-t)/1e3);window.console.log("PxLoader elapsed: "+a+" sec");for(var n=0,r=i.length;n<r;n++){var l=i[n];if(e||l.status===o.WAITING){var s="PxLoader: #"+n+" "+l.resource.getName();switch(l.status){case o.QUEUED:s+=" (Not Started)";break;case o.WAITING:s+=" (Waiting)";break;case o.LOADED:s+=" (Loaded)";break;case o.ERROR:s+=" (Error)";break;case o.TIMEOUT:s+=" (Timeout)"}l.resource.tags.length>0&&(s+=" Tags: ["+l.resource.tags.all.join(",")+"]"),window.console.log(s)}}}}}function n(e){if(this.all=[],this.first=null,this.length=0,this.lookup={},e){if(Array.isArray(e))this.all=e.slice(0);else if("object"===("undefined"==typeof e?"undefined":o(e)))for(var t in e)e.hasOwnProperty(t)&&this.all.push(t);else this.all.push(e);this.length=this.all.length,this.length>0&&(this.first=this.all[0]);for(var i=0;i<this.length;i++)this.lookup[this.all[i]]=!0}}function r(e,t,i,a){var n=this,r=null;this.img=new Image,void 0!==a&&(this.img.crossOrigin=a),this.tags=t,this.priority=i;var o=function(){"complete"===n.img.readyState&&(u(),r.onLoad(n))},l=function(){u(),r.onLoad(n)},s=function(){u(),r.onError(n)},u=function(){n.unbind("load",l),n.unbind("readystatechange",o),n.unbind("error",s)};this.start=function(t){r=t,n.bind("load",l),n.bind("readystatechange",o),n.bind("error",s),n.img.src=e},this.checkStatus=function(){n.img.complete&&(u(),r.onLoad(n))},this.onTimeout=function(){u(),n.img.complete?r.onLoad(n):r.onTimeout(n)},this.getName=function(){return e},this.bind=function(e,t){n.img.addEventListener?n.img.addEventListener(e,t,!1):n.img.attachEvent&&n.img.attachEvent("on"+e,t)},this.unbind=function(e,t){n.img.removeEventListener?n.img.removeEventListener(e,t,!1):n.img.detachEvent&&n.img.detachEvent("on"+e,t)}}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};n.prototype.intersects=function(e){if(0===this.length||0===e.length)return!1;if(1===this.length&&1===e.length)return this.first===e.first;if(e.length<this.length)return e.intersects(this);for(var t in this.lookup)if(e.lookup[t])return!0;return!1},a.prototype.addImage=function(e,t,i,a){var n=new r(e,t,i,a);return this.add(n),n.img},Date.now||(Date.now=function(){return(new Date).getTime()}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),t.exports=a},{}],2:[function(e,t,i){"use strict";t.exports={USER:{E_FORMAT:"EUSER_FORMAT",E_SIZE_EXCEEDED:"EUSER_SIZE_EXCEEDED",E_SIZE_INFERIOR:"EUSER_SIZE_INFERIOR"}}},{}],3:[function(e,t,i){"use strict";var a={_id:null,_type:null,_$container:null,_$validations:null,_$dropzone:null,_$msg:null,_url:null,_file:null,_name:null,_width:null,_height:null,_uploading:!1,type:"all",url:null,name:"",enableReupload:!0,imageContain:!1,imageResize:!0,imageMinHeight:100,imageMaxHeight:400,canRemove:!0,showValidations:!0,handler:null,fileupload:{url:"/api/files",type:"POST",paramName:"file",dataType:"json",singleFileUploads:!0,limitMultiFileUploads:1,sequentialUploads:!0,autoUpload:!0,fileInput:null,dropZone:null,replaceFileInput:!1,maxNumberOfFiles:1,minFileSize:1,maxFileSize:2e6,acceptFileTypes:void 0},types:{all:{name:"file",formats:void 0,formatsText:"any"},image:{name:"image",formats:/(\.|\/)(gif|jpe?g|png)$/i,formatsText:"JPG, JPEG, PNG and GIF"},pdf:{name:"PDF file",formats:/(application\/pdf|application\/x\-pdf)/i,formatsText:"PDF"}},messages:{UPLOAD:"Drag and drop {{name}} or browse",UPLOADING:"Uploading",REUPLOAD:"Click to upload a new {{name}}",UPLOADED:"Uploaded",ERROR:"Error, please try again",REMOVE:"Remove {{name}}",EUSER_FORMAT:"File format is invalid. Accepted file types include: {{formatsText}}.",EUSER_SIZE_EXCEEDED:"File exceeds the maximum size: {{maxSize}}. Please use another.",EUSER_SIZE_INFERIOR:"File size is below the minimum size: {{minSize}}. Please use another."},icons:{UPLOAD:"mdi mdi-cloud-upload",UPLOADING:"mdi mdi-cloud",REUPLOAD:"mdi mdi-cloud-upload",UPLOADED:"mdi mdi-cloud-check",ERROR:"mdi mdi-alert",REMOVE:"mdi mdi-close"}};t.exports=a},{}],4:[function(e,t,i){"use strict";var a=e("./constants");$.blueimp.fileupload.prototype.options.processQueue.push({action:"vulcanupValidation",always:!0,acceptFileTypes:"@",maxFileSize:"@",minFileSize:"@",maxNumberOfFiles:"@",disabled:"@disableValidation"}),$.widget("blueimp.fileupload",$.blueimp.fileupload,{options:{getNumberOfFiles:$.noop,messages:{maxNumberOfFiles:"ERROR",acceptFileTypes:a.USER.E_FORMAT,maxFileSize:a.USER.E_SIZE_EXCEEDED,minFileSize:a.USER.E_SIZE_INFERIOR}},processActions:{vulcanupValidation:function(e,t){if(t.disabled)return e;var i,a=$.Deferred(),n=this.options,r=e.files[e.index];return(t.minFileSize||t.maxFileSize)&&(i=r.size),"number"===$.type(t.maxNumberOfFiles)&&(n.getNumberOfFiles()||0)+e.files.length>t.maxNumberOfFiles?r.error=n.i18n("maxNumberOfFiles"):!t.acceptFileTypes||t.acceptFileTypes.test(r.type)||t.acceptFileTypes.test(r.name)?i>t.maxFileSize?r.error=n.i18n("maxFileSize"):"number"===$.type(i)&&i<t.minFileSize?r.error=n.i18n("minFileSize"):delete r.error:r.error=n.i18n("acceptFileTypes"),r.error||e.files.error?(e.files.error=!0,a.rejectWith(this,[e])):a.resolveWith(this,[e]),a.promise()}}})},{"./constants":2}],5:[function(e,t,i){"use strict";var a=e("./PxLoader"),n=(e("./constants"),e("./utils")),r={update:function(e){this.data("vulcanup-config");return e=$.extend(e,{noXHR:!0}),r.setUploaded.call(this,e),this},get:function(){var e=this.data("vulcanup-config");return e._url?{url:e._url,name:e._name}:null},setUpload:function(){var e=this.data("vulcanup-config");e._url=null,e._name=null,r.reset.call(this);var t=n.format(e.messages.UPLOAD,e._type);e._$msg.html('<i class="'+e.icons.UPLOAD+'"></i> '+t)},setUploading:function(){var e=this.data("vulcanup-config");r.hideValidation.call(this),r.reset.call(this),e._$container.addClass("vulcanup_uploading");var t=n.format(e.messages.UPLOADING,e._type);e._$msg.html('<i class="'+e.icons.UPLOADING+'"></i> '+t),e._uploading=!0,this.trigger("vulcanup-upload"),r.updateProgress.call(this,0)},updateProgress:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];e=Math.max(0,e),e=Math.min(100,e);var i=this.data("vulcanup-config");i._$container.find(".vulcanup__progressbar span").width(e+"%"),t.silent||this.trigger("vulcanup-progress",e)},setError:function(e){var t=this.data("vulcanup-config");r.reset.call(this),r.updateProgress.call(this,100);var i=n.format(t.messages.ERROR,t._type);t._$container.addClass("vulcanup_error"),t._$msg.html('<i class="'+t.icons.ERROR+'"></i> '+i),t._uploading=!1,this.trigger("vulcanup-error",e),this.trigger("vulcanup-complete")},setUploaded:function(e){var t=e.url,i=e.file,a=e.name,o=e.initial,l=e.noXHR;if("string"!=typeof t||!t.length)throw new Error("An URL path is required");var s=this.data("vulcanup-config");s._url=t,s._file=i,s._name=a,r.hideValidation.call(this),r.reset.call(this),r.updateProgress.call(this,100,{silent:!0}),s._$container.addClass("vulcanup_uploaded");var u=void 0,c=void 0;s.enableReupload?(u='<i class="'+s.icons.REUPLOAD+'"></i>',c=n.format(s.messages.REUPLOAD,s._type)):(u='<i class="'+s.icons.UPLOADED+'"></i>',c=a?a:i&&i.name?i.name:n.format(s.messages.UPLOADED,s._type)),s._$msg.html(u+" "+c),"image"===s.type&&r.loadImage.call(this),s._uploading=!1,o||(this.trigger("vulcanup-change",{url:t,name:i&&i.name?i.name:a}),l||(this.trigger("vulcanup-uploaded"),this.trigger("vulcanup-complete")))},reset:function(){var e=this.data("vulcanup-config");e._$container.removeClass(["vulcanup_uploading","vulcanup_uploaded","vulcanup_error"].join(" ")),e._$dropzone.removeAttr("style")},resize:function(){var e=this.data("vulcanup-config");if(e.imageResize){var t=e._$dropzone,i=e._width,a=e._height,n=t.width(),r=void 0;r=i&&a?Math.round(n*a/i):Math.round(.55*n),e.imageMinHeight&&(r=Math.max(r,e.imageMinHeight)),e.imageMaxHeight&&(r=Math.min(r,e.imageMaxHeight)),t.height(r)}},loadImage:function(e){var t=this,i=this.data("vulcanup-config");e=e||i._url||i.url,i._url=e;var n=($(this),i._$dropzone),o=new a,l=o.addImage(e);r.resize.call(this),n.css("background-image","url("+e+")"),o.addCompletionListener(function(){var e=l.naturalWidth||l.width,a=l.naturalHeight||l.height;i._width=e,i._height=a,r.resize.call(t)}),o.start()},setValidation:function(e){var t=this.data("vulcanup-config"),i=t.messages[e],a=$.extend({},t._type,{minSize:n.formatSize(t.fileupload.minFileSize),maxSize:n.formatSize(t.fileupload.maxFileSize)}),r=n.format(i,a);this.trigger("vulcanup-val",{error:r}),t.showValidations&&t._$validations.html(r).hide(0).show(300)},hideValidation:function(){var e=this.data("vulcanup-config");e.showValidations&&e._$validations.hide(300)}};t.exports=r},{"./PxLoader":1,"./constants":2,"./utils":7}],6:[function(e,t,i){"use strict";t.exports={main:['<div class="vulcanup">','<i class="vulcanup__remove {{icons.REMOVE}}" title=""></i>','<label class="vulcanup__dropzone" for="{{_id}}">','<div class="vulcanup__placeholder">','<span class="vulcanup__placeholder__content">','<span class="vulcanup__msg"></span>',"</span>","</div>","</label>",'<div class="vulcanup__progressbar">',"<span></span>","</div>","</div>"].join(""),validations:['<div class="vulcanup-validations"></div>'].join(".")}},{}],7:[function(e,t,i){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},n={removeArrayDuplicates:function(e){for(var t={},i=0;i<e.length;i++)t[e[i]]=!0;e=[];for(var a in t)e.push(a);return e},format:function(e,t){e=String(e),t=t||{};var i=function u(e,t,i){if(t[i])return"object"===a(e[t[i]])?u(e[t[i]],t,i+1):e[t[i]]},r=void 0,o=void 0,l=e.match(/\{\{\w+(\w|\.\w+)*\}\}/g);if(l&&l.length){l=n.removeArrayDuplicates(l),l=l.map(function(e){return e.replace("{{","").replace("}}","").split(".")});for(var s=0;s<l.length;s++)o=i(t,l[s],0),o&&(r=l[s].join("."),e=e.replace(new RegExp("{{"+r+"}}","g"),o))}return e},formatSize:function(e){var t="B";return e=Number(e),e>=1e6?(t="MB",e/=1e6):e>=1e3&&(t="KB",e/=1e3),e+" "+t}};t.exports=n},{}],8:[function(e,t,i){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};e("./jup-validation");var n=e("./templates"),r=(e("./constants"),e("./defaults")),o=e("./methods"),l=e("./utils"),s="1.0.0-beta";$(document).on("drop dragover",function(e){e.preventDefault()}),jQuery.fn.vulcanup=function(e){var t=$(this).first();if("string"==typeof e){if(o[e]){if(!t.data("vulcanup-config"))throw new Error("vulcanup element is not instantiated, cannot invoke methods");var i=Array.prototype.slice.call(arguments,1);return o[e].apply(t,i)}throw new Error('vulcanup method unrecognized "'+e+'".')}if(t.data("vulcanup-config"))return this;var s=t.attr("id");if(s||(s="vulcanup-"+(new Date).getTime(),t.attr("id",s)),void 0!==t.attr("multiple"))throw new Error("Input type file cannot be multiple");var u=$.extend(!0,{},r,e,{_id:s,fileupload:{fileInput:t}});if(!u.types[u.type])throw new Error("A valid type of file is required");u._type=u.types[u.type],u.fileupload.acceptFileTypes=u._type.formats,t.data("vulcanup-config",u);var c=$(l.format(n.main,u)),d=$(l.format(n.validations,u)),p=c.find(".vulcanup__remove"),f=c.find(".vulcanup__dropzone"),m=c.find(".vulcanup__msg");return p.attr("title",l.format(u.messages.REMOVE,u._type)),t.addClass("vulcanup-input vulcanup-input__hidden"),t.after(c),c.after(d),u.fileupload.dropZone=c,u._$validations=d,u._$container=c,u._$dropzone=f,u._$msg=m,"image"===u.type&&c.addClass("vulcanup_isimage"),u.imageContain&&c.addClass("vulcanup_isimagecontain"),u.enableReupload||c.addClass("vulcanup_noreupload"),u.canRemove&&c.addClass("vulcanup_canremove"),t.on("click",function(e){if(u._uploading||u._url&&!u.enableReupload)return e.preventDefault(),!1}).on("fileuploadprocessfail",function(e,i){var a=i.files[0].error;o.setValidation.call(t,a)}).on("fileuploadsend",function(e,i){o.setUploading.call(t)}).on("fileuploadprogressall",function(e,i){var a=parseInt(i.loaded/i.total*100,10);o.updateProgress.call(t,a)}).on("fileuploaddone",function(e,i){var n=i.files,r=i.result;if(u.handler){var l=u.handler(r);if("object"!==("undefined"==typeof l?"undefined":a(l)))throw o.setError.call(t),new Error("handler should return file object info");if("string"!=typeof l.url)throw o.setError.call(t),new Error("handler should return file url property");o.setUploaded.call(t,{url:l.url,file:n[0]})}else r&&r.files&&r.files.length?o.setUploaded.call(t,{url:r.files[0].url,file:n[0]}):o.setError.call(t)}).on("fileuploadfail",function(e,i){o.setError.call(t)}),f.on("dragenter dragover",function(e){c.addClass("vulcanup_dragover")}).on("dragleave drop",function(e){c.removeClass("vulcanup_dragover")}),c.find(".vulcanup__remove").on("click",function(e){return e.preventDefault(),t.trigger("vulcanup-delete",{url:u._url,name:u._name}),t.trigger("vulcanup-change",{url:null,name:null}),o.updateProgress.call(t,0,{silent:!0}),o.setUpload.call(t),!1}),t.fileupload(u.fileupload),u.url?o.setUploaded.call(this,{url:u.url,name:u.name,initial:!0}):o.setUpload.call(this),this},t.exports=jQuery.vulcanup={version:s,defaults:r,templates:n}},{"./constants":2,"./defaults":3,"./jup-validation":4,"./methods":5,"./templates":6,"./utils":7}]},{},[8]);